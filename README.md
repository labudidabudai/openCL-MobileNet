#MobileNet на OpenCL

Реализация нейросети MobileNet с помощью OpenCL. Хост создаёт слои нейросети, которые запускают соответсвующие ядра на OpenCL на указанном устройстве.

##Сборка

`make main` -- сборка основного приложения, реализующее нейросеть.
`make with_debug` -- сборка нейросети с дебажной инофрмациией.
`make devices` -- сборка приложения, выводящее список устройств, на которых возможен запуск OpenCL, вместе с информацией об этих устройствах.

Перед сборкой обязательно должна быть экспортирована переменная окружения `OPENCL_LIB_PATH`, в которой указана директория с библиотекой `OpenCL.so`, например:
```
export OPENCL_LIB_PATH=/opt/intel/system_studio_2019/opencl/SDK/lib64
```

Также так как код может выполняться на различных хостах с различными подключёнными устройствами, в файле `main.cpp` есть функция `setup_context`, которая позволяет выбрать, на каком устройстве выполнять ядра OpenCL (по умолчанию это первое устройство из списка). Чтобы посмотреть все имеющиеся устройства, можно собрать цель `devices` и запустить её.

##Запуск
###Реализация MobileNet
```
./opencl_mobilenet [файл с входными изображениями] [файл для вывода]
```
Нейросеть читает файл с изображениями и выводит результат в файл для вывода. Если была собрана дебажная версия, то также печатаются все промежуточные слои в файл `debug_{номер слоя}`.

####Формат файла изображений
Сначала идёт количество изображений, затем информация по каждому из них: количество строк, столбцов и каналов и дальше сами данные. Пример файла изображений лежит в репозитории (`images_list.txt`).

###Список доступных устройств
```
./devices
```
Приложение просто выводит список устройств, на которых возможны вычисления. Это можно использовать для выбора устройств в `main.cpp`.

